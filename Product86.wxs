<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
	
    <Product Id="592C8832-0B26-4A39-AA92-AFEBC04ABC1E" 
             Name="ITG Asia Pac FIX Client" 
             Language="1033" 
             Version="3.31.0.0" 
             Manufacturer="ITG Asia Pac" 
             UpgradeCode="D8168A89-9FE5-409B-921D-CC50929A7B4C">
		
        <Package InstallerVersion="405" Compressed="yes" InstallScope="perMachine" Platform="x86" InstallPrivileges="elevated"/>

		<MajorUpgrade DowngradeErrorMessage="A newer version of [ProductName] is already installed." />
        <MediaTemplate EmbedCab="yes"/>

        <UIRef Id="WixUI_MondoNoLicense"/>
        <WixVariable Id="WixUIDialogBmp" Value="Resources\InstallerDialog.bmp" />
        <WixVariable Id="WixUIBannerBmp" Value="Resources\InstallerBanner.bmp" />

        <Icon Id="Icon.ico" SourceFile="FixClient\Resources\FixClient.ico"/>
        <Property Id="ARPPRODUCTICON" Value="Icon.ico" />

        <Directory Id="TARGETDIR" Name="SourceDir">
            <Directory Id="ProgramFilesFolder">
                <Directory Id="ITGFolder" Name="ITG">
                    <Directory Id="AsiaPacFolder" Name="Asia Pac">
                        <Directory Id="INSTALLFOLDER" Name="FIX Client"/>
                    </Directory>
                </Directory>
            </Directory>
            <Directory Id="ProgramMenuFolder">
                <Directory Id="ProgramMenuSubfolder" Name="ITG Asia Pac">
                    <Component Id="ApplicationShortcuts" Guid="29EBE110-9866-4FE8-A7AD-6B13BB2420E2">
                        <Shortcut Id="ApplicationShortcut1" Name="FIX Client" Description="ITG Asia Pac FIX Client"
                                  Target="[INSTALLFOLDER]FixClient.exe" WorkingDirectory="INSTALLFOLDER"/>
                        <RegistryValue Root="HKCU" Key="Software\ITG Asia Pac\FIX Client" Name="installed" Type="integer" Value="1" KeyPath="yes"/>
                        <RemoveFolder Id="ProgramMenuSubfolder" On="uninstall"/>
                    </Component>
                </Directory>
            </Directory>
        </Directory>

        <Feature Id="FixClientFeature" Title="FIX Client" Display="expand" Level="1" ConfigurableDirectory="INSTALLFOLDER">
            <ComponentGroupRef Id="FixClientComponents" />
        </Feature>
        
        <ComponentGroup Id="FixClientComponents" Directory="INSTALLFOLDER">
            <Component Id="FixClient" Guid="C945FD77-11AD-4EDC-979A-ADE4659B874B">
                <File Id="FixClient" Name="$(var.FixClient.TargetFileName)" Source="$(var.FixClient.TargetPath)" DiskId="1" KeyPath="yes" />
                <File Id="ChangeLog" Name="CHANGELOG.TXT" Source="$(var.FixClient.ProjectDir)/CHANGELOG.TXT" DiskId="1" />
                <File Id="CustomFields" Name="CustomFields.xml" Source="$(var.FixClient.ProjectDir)/CustomFields.xml" DiskId="1" />
                <File Id="Fix" Name="$(var.Fix.TargetFileName)" Source="$(var.Fix.TargetPath)" DiskId="1" />
                <File Id="Dictionary" Name="$(var.Dictionary.TargetFileName)" Source="$(var.Dictionary.TargetPath)" DiskId="1" />
                <File Id="Newtonsoft.Json" Name="Newtonsoft.Json.dll" Source="$(var.Fix.TargetDir)/Newtonsoft.Json.dll" DiskId="1" />
            </Component>
            <ComponentRef Id="ApplicationShortcuts"/>
        </ComponentGroup>
        
	</Product>

    <Fragment>
        <UI Id="WixUI_MondoNoLicense">
            <TextStyle Id="WixUI_Font_Normal" FaceName="Tahoma" Size="8" />
            <TextStyle Id="WixUI_Font_Bigger" FaceName="Tahoma" Size="12" />
            <TextStyle Id="WixUI_Font_Title" FaceName="Tahoma" Size="9" Bold="yes" />
            <Property Id="DefaultUIFont" Value="WixUI_Font_Normal" />
            <Property Id="WixUI_Mode" Value="Mondo" />
            <DialogRef Id="ErrorDlg" />
            <DialogRef Id="FatalError" />
            <DialogRef Id="FilesInUse" />
            <DialogRef Id="MsiRMFilesInUse" />
            <DialogRef Id="PrepareDlg" />
            <DialogRef Id="ProgressDlg" />
            <DialogRef Id="ResumeDlg" />
            <DialogRef Id="UserExit" />
            <Publish Dialog="ExitDialog" Control="Finish" Event="EndDialog" Value="Return" Order="999">1</Publish>
            <Publish Dialog="WelcomeDlg" Control="Next" Event="NewDialog" Value="SetupTypeDlg">1</Publish>
            <Publish Dialog="SetupTypeDlg" Control="Back" Event="NewDialog" Value="WelcomeDlg">1</Publish>
            <Publish Dialog="SetupTypeDlg" Control="TypicalButton" Event="NewDialog" Value="VerifyReadyDlg">1</Publish>
            <Publish Dialog="SetupTypeDlg" Control="CustomButton" Event="NewDialog" Value="CustomizeDlg">1</Publish>
            <Publish Dialog="SetupTypeDlg" Control="CompleteButton" Event="NewDialog"                Value="VerifyReadyDlg">1</Publish>
            <Publish Dialog="CustomizeDlg" Control="Back" Event="NewDialog" Value="MaintenanceTypeDlg"                Order="1">WixUI_InstallMode = "Change"</Publish>
            <Publish Dialog="CustomizeDlg" Control="Back" Event="NewDialog" Value="SetupTypeDlg"                Order="2">WixUI_InstallMode = "InstallCustom"</Publish>
            <Publish Dialog="CustomizeDlg" Control="Next" Event="NewDialog" Value="VerifyReadyDlg">1</Publish>
            <Publish Dialog="VerifyReadyDlg" Control="Back" Event="NewDialog" Value="CustomizeDlg"                Order="1">WixUI_InstallMode = "InstallCustom"</Publish>
            <Publish Dialog="VerifyReadyDlg" Control="Back" Event="NewDialog" Value="SetupTypeDlg"                Order="2">WixUI_InstallMode = "InstallTypical" OR WixUI_InstallMode = "InstallComplete"</Publish>
            <Publish Dialog="VerifyReadyDlg" Control="Back" Event="NewDialog" Value="CustomizeDlg"                Order="3">WixUI_InstallMode = "Change"</Publish>
            <Publish Dialog="VerifyReadyDlg" Control="Back" Event="NewDialog" Value="MaintenanceTypeDlg"                Order="4">WixUI_InstallMode = "Repair" OR WixUI_InstallMode = "Remove"</Publish>
            <Publish Dialog="MaintenanceWelcomeDlg" Control="Next" Event="NewDialog"                Value="MaintenanceTypeDlg">1</Publish>
            <Publish Dialog="MaintenanceTypeDlg" Control="ChangeButton" Event="NewDialog"                Value="CustomizeDlg">1</Publish>
            <Publish Dialog="MaintenanceTypeDlg" Control="RepairButton" Event="NewDialog"                Value="VerifyReadyDlg">1</Publish>
            <Publish Dialog="MaintenanceTypeDlg" Control="RemoveButton" Event="NewDialog"                Value="VerifyReadyDlg">1</Publish>
            <Publish Dialog="MaintenanceTypeDlg" Control="Back" Event="NewDialog"                Value="MaintenanceWelcomeDlg">1</Publish>
        </UI>
        <UIRef Id="WixUI_Common" />
    </Fragment>
</Wix>